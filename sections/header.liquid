{%- comment -%}
  Modern Glassmorphism Header
  - Glassmorphism effect with backdrop blur
  - Sticky positioning
  - Flexbox layout: Menu (left) | Logo (center) | Icons (right)
{%- endcomment -%}

{% liquid
  # Capture header components
  capture logo
    content_for 'block', type: '_header-logo', id: 'header-logo'
  endcapture
  
  capture menu
    content_for 'block', type: '_header-menu', id: 'header-menu'
  endcapture
  
  capture mobile_menu
    content_for 'block', type: '_header-menu', id: 'header-menu', variant: 'mobile'
  endcapture
  
  capture actions
    render 'header-actions'
  endcapture
  
  # Search
  assign search_style = 'none'
  if section.settings.show_search
    assign search_style = 'modal'
  endif
  
  capture search
    render 'search', style: search_style
  endcapture
  
  # Localization
  assign show_language = section.settings.show_language
  if localization.available_languages.size <= 1
    assign show_language = false
  endif
  
  assign show_country = section.settings.show_country
  if localization.available_countries.size <= 1
    assign show_country = false
  endif
  
  assign localization_markup = blank
  if show_country or show_language
    capture localization_markup
      render 'dropdown-localization', 
        show_country: show_country, 
        show_language: show_language, 
        country_style: section.settings.country_selector_style, 
        localization_position: section.settings.localization_position
    endcapture
  endif
  
  # Sticky header - always enabled
  assign sticky = 'always'
-%}

{%- comment -%} Schema.org structured data {%- endcomment -%}
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": {{ shop.name | json }},
  {% if settings.logo %}
    "logo": {{ settings.logo | image_url: width: 500 | prepend: "https:" | json }},
  {% endif %}
  "url": {{ request.origin | append: page.url | json }}
}
</script>

{%- comment -%} Main header component {%- endcomment -%}
<header-component
  id="header-component"
  class="header header--glassmorphism"
  sticky="{{ sticky }}"
  data-skip-node-update
  data-scroll-direction="none"
>
  {%- if request.page_type == 'index' -%}
    <h1 class="visually-hidden">{{ shop.name }}</h1>
  {%- endif -%}
  
  <div class="header__container" ref="headerRowTop">
    {%- comment -%} Mobile menu button {%- endcomment -%}
    <div class="header__mobile-menu">
      {{ mobile_menu }}
    </div>
    
    {%- comment -%} Left: Menu {%- endcomment -%}
    <div class="header__left" ref="headerMenu">
      {{ menu }}
    </div>
    
    {%- comment -%} Center: Logo {%- endcomment -%}
    <div class="header__center">
      {{ logo }}
    </div>
    
    {%- comment -%} Right: Search, Localization, Actions {%- endcomment -%}
    <div class="header__right">
      {% if search_style != 'none' %}
        {{ search }}
      {% endif %}
      {% if localization_markup != blank %}
        {{ localization_markup }}
      {% endif %}
      {{ actions }}
    </div>
  </div>
  
  {%- comment -%} Header drawer container for mobile menu {%- endcomment -%}
  <div ref="headerDrawerContainer"></div>
</header-component>

{%- comment -%} Header JavaScript {%- endcomment -%}
<script
  src="{{ 'header.js' | asset_url }}"
  type="module"
></script>

{%- comment -%} Modern Glassmorphism Header Styles {%- endcomment -%}
{% stylesheet %}
  /* Header height variable */
  body {
    --header-height: 80px;
    --header-group-height: var(--header-height);
  }

  /* Header container - Flexbox layout */
  .header__container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    max-width: 100%;
    padding: var(--padding-md) var(--padding-xl);
    gap: var(--gap-xl);
    position: relative;
    z-index: 1;
    min-height: var(--header-height);
  }

  /* Glassmorphism effect */
  .header--glassmorphism {
    background: rgba(255, 255, 255, 0.8) !important;
    backdrop-filter: blur(12px) saturate(180%);
    -webkit-backdrop-filter: blur(12px) saturate(180%);
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
  }

  /* Sticky positioning */
  .header-section:has(> #header-component[sticky='always']),
  .header-section:has(> #header-component[sticky='scroll-up'][data-sticky-state='active']) {
    position: sticky;
    top: 0;
    z-index: 9999;
  }

  .header--glassmorphism {
    position: relative;
    width: 100%;
  }

  /* Left section - Menu */
  .header__left {
    display: flex;
    align-items: center;
    flex: 0 0 auto;
    order: 1;
  }

  /* Center section - Logo */
  .header__center {
    display: flex;
    align-items: center;
    justify-content: center;
    flex: 1 1 auto;
    order: 2;
  }

  /* Right section - Icons */
  .header__right {
    display: flex;
    align-items: center;
    gap: var(--gap-md);
    flex: 0 0 auto;
    order: 3;
  }

  /* Mobile menu button */
  .header__mobile-menu {
    display: none;
    order: 0;
  }

  /* Mobile responsive */
  @media screen and (max-width: 749px) {
    .header__container {
      padding: 0 var(--padding-md);
      gap: var(--gap-md);
    }

    .header__left {
      display: none; /* Hide desktop menu on mobile */
    }

    .header__mobile-menu {
      display: block;
    }

    .header__center {
      flex: 1 1 auto;
      justify-content: center;
    }

    .header__right {
      gap: var(--gap-sm);
    }

    body {
      --header-height: 70px;
    }
  }

  /* Clean menu styles - no backgrounds */
  .header--glassmorphism .menu-list__link,
  .header--glassmorphism .menu-list__list-item,
  .header--glassmorphism .header__menu-item {
    background: transparent !important;
    background-color: transparent !important;
    color: var(--color-foreground, #1a1a1a) !important;
    padding: var(--padding-xs) var(--padding-sm);
    margin: 0;
    border-radius: 0;
    transition: color 0.3s ease;
  }

  .header--glassmorphism .menu-list__link:hover,
  .header--glassmorphism .menu-list__link:focus {
    background: transparent !important;
    background-color: transparent !important;
    color: var(--color-foreground, #1a1a1a) !important;
    opacity: 0.7;
  }

  /* Menu list spacing */
  .header--glassmorphism .menu-list__list {
    display: flex;
    gap: var(--gap-lg);
    align-items: center;
  }

  /* Remove any button-like backgrounds from menu items */
  .header--glassmorphism .menu-list__list-item {
    background: none !important;
    border: none !important;
    padding: 0 !important;
    margin: 0 !important;
  }

  /* Remove any old background colors from header elements (except the header itself) */
  .header--glassmorphism .menu-list__link,
  .header--glassmorphism .menu-list__list-item,
  .header--glassmorphism .header__menu-item,
  .header--glassmorphism .header-actions__action,
  .header--glassmorphism .search-action button,
  .header--glassmorphism .dropdown-localization__button {
    background-color: transparent !important;
    background: transparent !important;
  }
  
  /* Glassmorphism background only on header element */
  .header--glassmorphism {
    background: rgba(255, 255, 255, 0.8) !important;
  }

  /* Logo styling */
  .header--glassmorphism .header-logo {
    display: flex;
    align-items: center;
  }

  /* Actions styling */
  .header--glassmorphism .header-actions__action {
    background: transparent !important;
    border: none !important;
    color: var(--color-foreground, #1a1a1a);
  }

  /* Search button styling */
  .header--glassmorphism .search-action button {
    background: transparent !important;
    border: none !important;
    color: var(--color-foreground, #1a1a1a);
  }

  /* Localization button styling */
  .header--glassmorphism .dropdown-localization__button {
    background: transparent !important;
    border: none !important;
    color: var(--color-foreground, #1a1a1a);
  }

  /* Smooth transitions */
  .header--glassmorphism {
    transition: background-color 0.3s ease, backdrop-filter 0.3s ease;
  }

  /* Ensure content scrolls under header */
  body:has(.header--glassmorphism) {
    padding-top: 0;
  }

  main > .shopify-section:first-child {
    margin-top: 0;
  }
{% endstylesheet %}

{% unless request.design_mode %}
  <script type="module">
    import { hydrate } from '@theme/section-hydration';
    const url = new URL(window.location.href);
    url.searchParams.delete('page');
    hydrate('{{ section.id }}', url);
  </script>
{% endunless %}

{% schema %}
{
  "name": "t:names.header",
  "tag": "header",
  "class": "header-section",
  "settings": [
    {
      "type": "header",
      "content": "t:content.logo"
    },
    {
      "type": "select",
      "id": "logo_position",
      "label": "t:settings.position",
      "options": [
        {
          "value": "left",
          "label": "t:options.left"
        },
        {
          "value": "center",
          "label": "t:options.center"
        },
        {
          "value": "right",
          "label": "t:options.right"
        }
      ],
      "default": "center"
    },
    {
      "type": "header",
      "content": "t:content.menu"
    },
    {
      "type": "select",
      "id": "menu_position",
      "label": "t:settings.position",
      "options": [
        {
          "value": "left",
          "label": "t:options.left"
        },
        {
          "value": "center",
          "label": "t:options.center"
        },
        {
          "value": "right",
          "label": "t:options.right"
        }
      ],
      "default": "left"
    },
    {
      "type": "header",
      "content": "t:content.search"
    },
    {
      "type": "checkbox",
      "id": "show_search",
      "label": "t:settings.search_icon",
      "default": true
    },
    {
      "type": "header",
      "content": "t:content.localization"
    },
    {
      "type": "checkbox",
      "id": "show_country",
      "label": "t:settings.country_region",
      "info": "t:info.manage_countries_regions",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "country_selector_style",
      "label": "t:settings.flag",
      "default": true,
      "visible_if": "{{ section.settings.show_country }}"
    },
    {
      "type": "checkbox",
      "id": "show_language",
      "label": "t:settings.language_selector",
      "info": "t:info.manage_languages",
      "default": true
    },
    {
      "type": "select",
      "id": "localization_position",
      "label": "t:settings.position",
      "options": [
        {
          "value": "left",
          "label": "t:options.left"
        },
        {
          "value": "right",
          "label": "t:options.right"
        }
      ],
      "default": "right",
      "visible_if": "{{ section.settings.show_country or section.settings.show_language }}"
    }
  ],
  "presets": []
}
{% endschema %}
